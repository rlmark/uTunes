
<h2>Shopping Cart</h2>



<table class="cart">

  <tr>
    <th>
      Product Name
    </th>
    <th>
      Price
    </th>
    <th>
      Quantity Ordered
    </th>
    <th>
      Delete Item
    </th>
    <th>
      Number In Stock*
    </th>
    <th>
      Total Price
    </th>
  </tr>
  <% @ordered_items.each do |item| %>
  <% if item.status == "pending" %>
  <tr>
    <td>
      <%= "#{Product.find(item.product_id).album_name}" %>
    </td>
    <td>
      <%= "#{number_to_currency(Product.find(item.product_id).price/100.0)}" %>
    </td>
    <td>
  <%= form_for item do |f| %>
    <%= f.hidden_field :item_id, value: item.id %>
    <%= f.number_field :quantity %>
    <%= submit_tag "Update" %>
  <% end %>
    </td>
    <td>
      <%= button_to "Delete", delete_ordered_item_path(item.id),  method: :delete %>
    </td>
    <td>
      <%= "#{Product.find(item.product_id).stock}" %>
    </td>

    <td>
      <%= "#{number_to_currency(Product.find(item.product_id).price * item.quantity/100.0)}" %>
    </td>
  </tr>
  <% end %>


  <% end%>
  <hr>
  <tr>
    <td></td>
    <td></td>
    <td></td>
    <td><%= "#{number_to_currency(@cart_total/100.0)}" %></td>
  </tr>
</table>


<div class="cart_button">
<%= link_to "Check Out", "/check_out" %>
</div>


<div class="cart_button">
<%= button_to "Empty Cart", empty_cart_path,  method: :delete %>
</div>


<div id="stock_remarks">
  *Your order will automatically be adjusted so as not to exceed the
  available stock.
</div>
